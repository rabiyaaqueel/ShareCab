<!DOCTYPE html>
<html>
<head>
    <title>User Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<h2>Welcome, {{ session['user']['name'] }}</h2>

<!-- Ride Form -->
<form method="POST" action="/show_rides">
    Pickup Location: <input type="text" name="pickup" required><br>
    Drop Location: <input type="text" name="drop" required><br>
    <input type="submit" value="Show Available Rides">
</form>

<!-- Chatbot Box -->
<div id="chatbox" style="margin:20px auto; max-width:400px; background:#fff; border-radius:8px; padding:15px; box-shadow:0 2px 6px rgba(0,0,0,0.1);">
    <h3>Ride Assistant</h3>
    <div id="messages" style="height:200px; overflow-y:auto; border:1px solid #ccc; padding:10px; margin-bottom:10px;"></div>
    <input type="text" id="user_input" placeholder="Ask me anything..." style="width:80%; padding:8px;">
    <button onclick="sendMessage()" style="padding:8px 12px;">Send</button>
</div>

<a href="/logout">Logout</a>

<script>
async function sendMessage() {
    let input = document.getElementById("user_input");
    let msg = input.value.trim();
    if (!msg) return;

    let messages = document.getElementById("messages");
    messages.innerHTML += "<div><b>You:</b> " + msg + "</div>";

    let response = await fetch("/chatbot", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: msg })
    });
    let data = await response.json();

    messages.innerHTML += "<div><b>Bot:</b> " + data.response + "</div>";
    messages.scrollTop = messages.scrollHeight;

    input.value = "";
}
</script>

</body>
</html>
